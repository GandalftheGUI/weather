<h1>Weather Search</h1>

<%= form_with url: weather_search_path, method: :get do %>
  <%= label_tag :zip, "Enter ZIP Code:" %>
  <%= text_field_tag :zip, nil, required: true %>
  <%= submit_tag "Get Weather" %>
<% end %>

<% if @weather.present? %>
  <% if @weather["error"] %>
    <p>Error: <%= @weather["error"] %></p>
  <% else %>
    <h2>Weather for <%= @weather["location"] %></h2>
    <p>Source: <%= @weather["source"] %></p>

    <h3>Current Weather</h3>
    <p>Temperature: <%= @weather["current"]["temperature"] %>°C</p>
    <p>High: <%= @weather["current"]["temp_max"] %>°C</p>
    <p>Low: <%= @weather["current"]["temp_min"] %>°C</p>
    <p>Conditions: <%= @weather["current"]["conditions"] %></p>
    <p>Humidity: <%= @weather["current"]["humidity"] %>%</p>
    <p>Wind Speed: <%= @weather["current"]["wind_speed"] %> m/s</p>

    <h3>5-Day Forecast</h3>
    <ul>
      <% @weather["forecast"].each do |day| %>
        <li>
          <strong><%= day[:date] %></strong>: 
          High: <%= day[:high] %>°C, 
          Low: <%= day[:low] %>°C
        </li>
      <% end %>
    </ul>
  <% end %>
<% end %>