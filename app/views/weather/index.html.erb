<h1>Weather Search</h1>

<%= form_with url: weather_search_path, method: :get do %>
  <%= label_tag :zip, "Enter ZIP Code:" %>
  <%= text_field_tag :zip, nil, required: true %>
  <%= submit_tag "Get Weather" %>
<% end %>

<% if @weather.present? %>
  <% if @weather["error"] %>
    <p>Error: <%= @weather["error"] %></p>
  <% else %>
    <h2>Weather for <%= @weather["location"] %></h2>
    <ul>
      <li>Source: <%= @weather["source"] %></li>
    </ul>

    <h3>Current Weather</h3>
    <ul>
      <li>Temperature: <%= @weather["current"]["temperature"] %>°C</li>
      <li>High: <%= @weather["current"]["temp_max"] %>°C</li>
      <li>Low: <%= @weather["current"]["temp_min"] %>°C</li>
      <li>Conditions: <%= @weather["current"]["conditions"] %></li>
      <li>Humidity: <%= @weather["current"]["humidity"] %>%</li>
      <li>Wind Speed: <%= @weather["current"]["wind_speed"] %> m/s</li>
    </ul>
    
    <h3>5-Day Forecast</h3>
    <ul>
      <% @weather["forecast"].each do |day| %>
        <li>
          <strong><%= day[:date] %></strong>: 
          High: <%= day[:high] %>°C, 
          Low: <%= day[:low] %>°C
        </li>
      <% end %>
    </ul>
  <% end %>
<% end %>